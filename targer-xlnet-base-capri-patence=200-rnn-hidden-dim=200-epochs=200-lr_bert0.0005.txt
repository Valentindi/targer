Evaluation

batch_size=10
bert=False
bert_frozen=True
char_cnn_filter_num=30
char_embeddings_dim=25
char_window_size=3
check_for_lowercase=True
clip_grad=5
cross_fold_id=-1
cross_folds_num=-1
data_io='connl-ner-2003'
dataset_sort=False
dev='data/targer/targer_dev.txt'
dropout_ratio=0.5
elmo=False
elmo_options_fn='embeddings/elmo_2x4096_512_2048cnn_2xhighway_5.5B_options.json'
elmo_weights_fn='/home/vika/targer/embeddings/elmo_2x4096_512_2048cnn_2xhighway_5.5B_weights.hdf5'
emb_delimiter=' '
emb_dim=100
emb_fn='embeddings/glove.6B.100d.txt'
emb_load_all=False
embedding_dim=768
epoch_num=200
evaluator='f1-macro'
freeze_char_embeddings=False
freeze_word_embeddings=False
gpu=3
load=None
logname='targer-xlnet-base-capri-patence=200-rnn-hidden-dim=200-epochs=200-lr_bert0.0005.log'
lr=0.005
lr_bert=0.0005
lr_decay=0.05
min_epoch_num=50
model='BiRNN'
momentum=0.9
opt='adam'
path_to_bert='xlnet-base-cased'
patience=200
report_fn='targer-xlnet-base-capri-patence=200-rnn-hidden-dim=200-epochs=200-lr_bert0.0005.txt'
rnn_hidden_dim=200
rnn_type='LSTM'
save='targer-xlnet-base-capri-patence=200-rnn-hidden-dim=200-epochs=200-lr_bert0.0005.hdf5'
save_best=True
seed_num=42
special_bert=True
splitter=' '
test='data/targer/targer_test.txt'
train='data/targer/targer_train.txt'
verbose=True
word_len=20
word_seq_indexer=None
xlnet=True

         epoch  |     train loss | f1-macro-train |   f1-macro-dev |  f1-macro-test 
--------------------------------------------------------------------------------------
              0 |         102.03 |          51.73 |          48.56 |          51.18 
              1 |          95.81 |          50.39 |          48.00 |          49.87 
              2 |          97.41 |          51.74 |          50.26 |          52.95 
              3 |          98.02 |          52.35 |          51.67 |          53.38 
              4 |          90.46 |          54.99 |          52.42 |          55.72 
              5 |          92.65 |          51.07 |          48.49 |          49.28 
              6 |          92.27 |          57.82 |          55.57 |          58.31 
              7 |          85.17 |          61.46 |          58.12 |          62.73 
              8 |          85.66 |          58.54 |          56.02 |          59.69 
              9 |          88.13 |          60.13 |          57.48 |          61.76 
             10 |          84.58 |          62.75 |          59.23 |          64.05 
             11 |          84.46 |          58.07 |          55.44 |          59.85 
             12 |          79.95 |          62.33 |          58.98 |          62.92 
             13 |          83.95 |          59.91 |          57.57 |          61.24 
             14 |          84.16 |          60.66 |          56.70 |          60.85 
             15 |          77.74 |          60.10 |          57.00 |          60.20 
             16 |          79.44 |          65.30 |          60.97 |          65.18 
             17 |          86.81 |          62.02 |          59.64 |          62.69 
             18 |          83.18 |          58.55 |          54.36 |          57.80 
             19 |          85.54 |          64.79 |          61.25 |          63.67 
             20 |          84.08 |          60.21 |          58.22 |          60.84 
             21 |          77.34 |          64.21 |          61.17 |          65.24 
             22 |          79.47 |          65.42 |          60.33 |          63.62 
             23 |          83.88 |          66.65 |          62.13 |          65.65 
             24 |          84.98 |          66.16 |          61.91 |          66.01 
             25 |          81.83 |          67.34 |          62.75 |          65.59 
             26 |          79.88 |          65.70 |          60.46 |          63.78 
             27 |          78.97 |          67.67 |          62.28 |          66.56 
             28 |          77.52 |          67.19 |          62.59 |          66.38 
             29 |          76.09 |          67.03 |          62.14 |          65.26 
             30 |          82.98 |          67.17 |          63.05 |          66.34 
             31 |          81.10 |          67.54 |          62.67 |          66.31 
             32 |          75.81 |          65.00 |          61.33 |          64.88 
             33 |          87.40 |          65.37 |          62.27 |          65.34 
             34 |          79.12 |          67.58 |          63.29 |          66.25 
             35 |          75.35 |          65.46 |          61.30 |          65.13 
             36 |          78.91 |          67.15 |          61.44 |          64.94 
             37 |          77.70 |          67.17 |          61.49 |          63.55 
             38 |          76.32 |          68.08 |          63.50 |          66.37 
             39 |          73.56 |          67.18 |          62.54 |          65.46 
             40 |          80.35 |          70.35 |          64.35 |          66.84 
             41 |          76.84 |          69.59 |          64.14 |          67.55 
             42 |          71.82 |          70.88 |          63.76 |          66.30 
             43 |          77.12 |          69.37 |          63.85 |          67.72 
             44 |          71.53 |          68.43 |          61.33 |          65.12 
             45 |          80.56 |          68.92 |          62.84 |          67.33 
             46 |          75.04 |          70.08 |          64.04 |          67.69 
             47 |          72.66 |          69.84 |          63.28 |          67.15 
             48 |          76.89 |          71.77 |          64.77 |          69.03 
             49 |          73.84 |          70.69 |          63.31 |          67.94 
             50 |          71.09 |          67.47 |          62.09 |          65.26 
             51 |          75.35 |          71.60 |          64.57 |          68.58 
             52 |          69.42 |          71.75 |          64.97 |          69.40 
             53 |          69.92 |          70.78 |          64.37 |          68.49 
             54 |          70.02 |          67.92 |          62.54 |          66.24 
             55 |          74.03 |          69.85 |          62.09 |          65.78 
             56 |          74.11 |          71.63 |          65.04 |          67.60 
             57 |          72.11 |          70.23 |          63.23 |          67.48 
             58 |          70.46 |          70.84 |          63.89 |          67.85 
             59 |          75.00 |          73.52 |          65.43 |          69.59 
             60 |          72.35 |          72.21 |          64.80 |          69.35 
             61 |          69.42 |          72.86 |          66.27 |          70.48 
             62 |          73.02 |          71.60 |          64.91 |          69.45 
             63 |          67.99 |          72.77 |          66.01 |          70.09 
             64 |          66.27 |          73.62 |          65.30 |          69.20 
             65 |          68.55 |          71.41 |          63.52 |          67.39 
             66 |          67.92 |          73.34 |          65.42 |          69.92 
             67 |          67.96 |          70.95 |          63.05 |          67.39 
             68 |          72.54 |          74.66 |          65.51 |          70.30 
             69 |          67.50 |          73.33 |          64.58 |          68.64 
             70 |          69.90 |          71.84 |          64.27 |          69.60 
             71 |          72.32 |          73.13 |          64.99 |          69.67 
             72 |          67.79 |          74.09 |          65.64 |          70.86 
             73 |          70.68 |          74.39 |          65.80 |          70.24 
             74 |          68.83 |          74.70 |          66.70 |          70.86 
             75 |          65.07 |          73.59 |          65.92 |          69.00 
             76 |          68.48 |          73.79 |          65.47 |          69.87 
             77 |          67.82 |          73.11 |          65.46 |          69.05 
             78 |          66.74 |          73.05 |          65.61 |          69.10 
             79 |          63.20 |          73.85 |          66.05 |          70.24 
             80 |          68.47 |          74.38 |          65.97 |          69.41 
             81 |          65.27 |          75.28 |          67.39 |          71.06 
             82 |          69.17 |          75.04 |          66.23 |          69.69 
             83 |          62.18 |          74.88 |          67.25 |          69.90 
             84 |          66.96 |          75.79 |          66.53 |          69.95 
             85 |          66.47 |          74.92 |          65.32 |          69.05 
             86 |          73.43 |          75.75 |          65.61 |          70.18 
             87 |          71.63 |          75.67 |          65.53 |          70.60 
             88 |          63.18 |          75.24 |          66.69 |          70.40 
             89 |          70.64 |          76.58 |          67.31 |          71.57 
             90 |          68.08 |          75.87 |          67.28 |          71.57 
             91 |          67.12 |          76.30 |          66.81 |          71.68 
             92 |          69.70 |          75.58 |          65.61 |          69.67 
             93 |          59.74 |          76.04 |          66.71 |          70.83 
             94 |          66.75 |          76.84 |          66.39 |          71.53 
             95 |          62.61 |          76.33 |          66.29 |          71.43 
             96 |          67.07 |          76.71 |          67.10 |          70.86 
             97 |          62.38 |          76.52 |          65.47 |          70.29 
             98 |          64.06 |          77.17 |          66.82 |          69.99 
             99 |          64.23 |          76.28 |          65.84 |          69.49 
            100 |          64.14 |          77.27 |          67.25 |          70.97 
            101 |          62.40 |          76.57 |          67.90 |          70.68 
            102 |          61.69 |          76.40 |          66.03 |          69.88 
            103 |          64.45 |          77.01 |          67.03 |          70.86 
            104 |          64.86 |          76.36 |          68.13 |          71.36 
            105 |          65.41 |          78.43 |          68.68 |          72.15 
            106 |          63.87 |          77.53 |          68.11 |          71.91 
            107 |          57.81 |          77.13 |          67.02 |          71.06 
            108 |          63.15 |          77.56 |          67.56 |          71.63 
            109 |          63.35 |          77.64 |          68.52 |          71.98 
            110 |          62.33 |          77.54 |          66.88 |          70.94 
            111 |          63.50 |          77.35 |          67.35 |          71.23 
            112 |          63.55 |          78.13 |          67.26 |          71.29 
            113 |          66.76 |          78.20 |          68.08 |          71.62 
            114 |          66.94 |          77.99 |          67.53 |          70.82 
            115 |          65.83 |          78.02 |          67.16 |          72.08 
            116 |          64.81 |          78.49 |          67.79 |          70.56 
            117 |          58.24 |          78.50 |          67.47 |          72.02 
            118 |          66.38 |          76.32 |          66.30 |          70.57 
            119 |          64.33 |          77.36 |          67.34 |          71.69 
            120 |          57.71 |          78.10 |          66.50 |          71.29 
            121 |          63.92 |          78.41 |          67.08 |          70.98 
            122 |          66.18 |          77.30 |          66.34 |          70.54 
            123 |          58.69 |          77.66 |          67.54 |          71.04 
            124 |          60.89 |          78.43 |          67.31 |          71.28 
            125 |          59.22 |          78.99 |          67.87 |          71.46 
            126 |          56.83 |          78.80 |          68.10 |          71.19 
            127 |          66.06 |          79.07 |          68.09 |          71.81 
            128 |          60.73 |          79.60 |          67.68 |          71.88 
            129 |          57.02 |          78.30 |          67.86 |          71.86 
            130 |          62.30 |          79.15 |          67.79 |          71.65 
            131 |          63.51 |          79.59 |          67.66 |          71.93 
            132 |          62.02 |          79.85 |          68.11 |          71.59 
            133 |          61.15 |          80.07 |          68.60 |          71.89 
            134 |          58.76 |          78.88 |          66.63 |          71.18 
            135 |          67.68 |          79.47 |          67.51 |          72.00 
            136 |          56.65 |          79.94 |          67.87 |          71.67 
            137 |          64.80 |          80.16 |          67.67 |          72.53 
            138 |          62.72 |          80.40 |          68.19 |          72.40 
            139 |          65.14 |          80.18 |          68.47 |          72.41 
            140 |          55.25 |          79.64 |          67.91 |          71.70 
            141 |          53.58 |          78.96 |          67.39 |          71.54 
            142 |          61.12 |          79.60 |          67.59 |          72.31 
            143 |          58.07 |          79.45 |          67.91 |          71.73 
            144 |          57.23 |          80.13 |          68.19 |          72.05 
            145 |          55.57 |          80.11 |          67.49 |          71.49 
            146 |          58.34 |          80.12 |          67.30 |          71.63 
            147 |          57.57 |          79.54 |          67.11 |          72.44 
            148 |          55.84 |          79.55 |          67.52 |          72.65 
            149 |          57.35 |          80.34 |          68.01 |          73.24 
            150 |          58.14 |          78.91 |          66.41 |          71.91 
            151 |          56.46 |          80.37 |          68.20 |          72.98 
            152 |          59.47 |          79.99 |          67.90 |          72.70 
            153 |          55.05 |          80.43 |          67.97 |          72.40 
            154 |          55.36 |          80.44 |          67.98 |          72.98 
            155 |          57.93 |          80.51 |          67.91 |          72.34 
            156 |          58.29 |          80.07 |          66.36 |          71.61 
            157 |          62.99 |          80.49 |          67.82 |          72.38 
            158 |          53.17 |          80.68 |          68.49 |          72.76 
            159 |          57.05 |          80.08 |          68.23 |          72.74 
            160 |          54.54 |          80.72 |          68.33 |          72.46 
            161 |          55.47 |          80.42 |          67.77 |          71.64 
            162 |          66.11 |          80.50 |          67.59 |          72.63 
            163 |          58.70 |          80.27 |          68.66 |          72.60 
            164 |          61.00 |          80.32 |          67.83 |          72.30 
            165 |          51.94 |          80.72 |          67.99 |          72.65 
            166 |          59.48 |          80.64 |          67.95 |          71.94 
            167 |          59.12 |          81.02 |          67.93 |          72.64 
            168 |          61.98 |          81.51 |          68.06 |          72.56 
            169 |          58.97 |          81.16 |          67.96 |          73.12 
            170 |          53.82 |          80.95 |          68.43 |          72.75 
            171 |          60.90 |          80.98 |          68.73 |          72.28 
            172 |          61.79 |          81.49 |          68.57 |          72.10 
            173 |          54.69 |          81.75 |          68.25 |          72.20 
            174 |          59.23 |          81.76 |          68.10 |          71.88 
            175 |          54.52 |          80.91 |          68.54 |          72.23 
            176 |          57.91 |          81.59 |          68.86 |          72.87 
            177 |          56.76 |          81.17 |          67.65 |          72.92 
            178 |          62.67 |          81.53 |          68.42 |          72.83 
            179 |          57.69 |          81.49 |          68.77 |          72.64 
            180 |          56.40 |          82.02 |          68.87 |          73.18 
            181 |          56.47 |          81.85 |          69.68 |          73.40 
            182 |          55.34 |          81.52 |          68.65 |          72.95 
            183 |          57.44 |          82.12 |          69.32 |          73.91 
            184 |          50.05 |          82.22 |          69.80 |          73.62 
            185 |          54.92 |          82.05 |          68.75 |          73.69 
            186 |          56.30 |          81.87 |          68.21 |          73.43 
            187 |          54.51 |          82.24 |          69.06 |          72.79 
            188 |          52.26 |          81.92 |          69.42 |          73.76 
            189 |          54.94 |          81.98 |          68.70 |          73.20 
            190 |          51.34 |          82.09 |          68.30 |          72.82 
            191 |          55.74 |          82.75 |          68.88 |          73.22 
            192 |          52.15 |          82.09 |          68.51 |          73.12 
            193 |          54.40 |          81.87 |          68.44 |          73.08 
            194 |          54.59 |          81.92 |          68.41 |          73.44 
            195 |          54.29 |          82.75 |          69.95 |          73.04 
            196 |          63.70 |          83.06 |          69.19 |          73.27 
            197 |          57.63 |          82.32 |          69.35 |          73.25 
            198 |          54.31 |          82.78 |          69.34 |          73.63 
            199 |          56.71 |          82.27 |          69.09 |          73.32 
--------------------------------------------------------------------------------------
Final eval on test, "save best", best epoch on dev 195, f1-macro, test = 73.04)
--------------------------------------------------------------------------------------
F1 scores
------------------------
              0 = f1 = 81.69, precision = 88.22, recall = 76.06
             CA = f1 = 51.19, precision = 58.71, recall = 45.38
             CC = f1 = 78.04, precision = 72.54, recall = 84.43
             CI = f1 = 70.72, precision = 69.58, recall = 71.91
             CP = f1 = 83.55, precision = 81.44, recall = 85.78
------------------------
Macro-F1 = 73.039Macro-Prescion = 74.097Macro-Recall = 72.712
              precision    recall  f1-score   support

          CC       0.73      0.84      0.78      1214
           0       0.88      0.76      0.82      1654
          CA       0.59      0.45      0.51       260
          CP       0.81      0.86      0.84       921
          CI       0.70      0.72      0.71      1164

   micro avg       0.77      0.77      0.77      5213
   macro avg       0.74      0.73      0.73      5213
weighted avg       0.78      0.77      0.77      5213


Input arguments:
python3 main.py --train data/targer/targer_train.txt --dev data/targer/targer_dev.txt --test data/targer/targer_test.txt --data-io connl-ner-2003 --model BiRNN --embedding-dim 768 --opt adam --save-best yes --patience 200 --rnn-hidden-dim 200 --gpu 3 --epoch-num 200 --evaluator f1-macro --xlnet True --path_to_bert xlnet-base-cased --special_bert True --lr_bert 0.0005 --logname targer-xlnet-base-capri-patence=200-rnn-hidden-dim=200-epochs=200-lr_bert0.0005.log --report-fn targer-xlnet-base-capri-patence=200-rnn-hidden-dim=200-epochs=200-lr_bert0.0005.txt --save targer-xlnet-base-capri-patence=200-rnn-hidden-dim=200-epochs=200-lr_bert0.0005.hdf5

73.0387